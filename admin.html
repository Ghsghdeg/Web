<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f5f5f5;
      text-align: center;
    }
    header {
      background-color: #19388A;
      color: white;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header h1 {
      margin: 0;
      font-size: 24px;
    }
    .nav-buttons {
      display: flex;
      gap: 10px;
    }
    .nav-buttons button {
      background-color: #fff;
      color: #19388A;
      border: none;
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 4px;
      transition: 0.3s;
    }
    .nav-buttons button:hover {
      background-color: #cfd9f2;
    }
    .panel {
      display: none;
      padding: 20px;
      animation: slideIn 0.4s ease forwards;
    }
    .panel.active {
      display: block;
    }
    @keyframes slideIn {
      from { transform: translateY(-10px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    input[type="text"], input[type="number"], select {
      padding: 8px;
      width: 300px;
      margin: 10px auto;
      border-radius: 4px;
      border: 1px solid #ccc;
      display: block;
      text-align: center;
    }
    button.action {
      background-color: #19388A;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 10px;
    }
    .video-list ul,
    #answers-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0;
      list-style-type: none;
    }
    #video-list li.selected {
      background-color: #cfd9f2;
      border-radius: 4px;
      padding: 5px;
    }
    .language-switcher {
      margin-left: 15px;
    }
    .language-switcher button {
      background-color: #fff;
      color: #19388A;
      border: 1px solid #19388A;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
  </style>
</head>
<body>

<header>
  <h1 id="adminTitle">–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</h1>
  <div class="nav-buttons">
    <button id="homeBtn" onclick="goToHome()">–ì–æ–ª–æ–≤–Ω–∞</button>
    <button id="videoBtn" onclick="showPanel('video')">–í—ñ–¥–µ–æ-—É—Ä–æ–∫–∏</button>
    <button id="testsBtn" onclick="showPanel('tests')">–¢–µ—Å—Ç–∏</button>
    <div class="language-switcher">
      <button onclick="toggleLang()">üåê UKR / ENG</button>
    </div>
  </div>
</header>

<div id="video" class="panel">
  <h2 id="videoListTitle">–°–ø–∏—Å–æ–∫ –≤—ñ–¥–µ–æ</h2>
  <div class="video-list">
    <ul id="video-list"></ul>
    <button class="action" id="deleteVideoBtn" onclick="deleteVideo()">–í–∏–¥–∞–ª–∏—Ç–∏</button>
  </div>
  <h2 id="addVideoTitle">–î–æ–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ</h2>
  <div class="video-add-form">
    <input type="text" id="video-title" placeholder="–ù–∞–∑–≤–∞ –≤—ñ–¥–µ–æ">
    <input type="text" id="video-url" placeholder="–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤—ñ–¥–µ–æ">
    <button class="action" id="addVideoBtn" onclick="addVideo()">–î–æ–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ</button>
  </div>
</div>

<div id="tests" class="panel">
  <h2 id="newTestTitle">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ç–µ–º—É —Ç–µ—Å—Ç—É</h2>
  <input type="text" id="new-test-title" placeholder="–ù–∞–∑–≤–∞ —Ç–µ–º–∏ —Ç–µ—Å—Ç—É">
  <button class="action" id="createTestBtn" onclick="createTest()">–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–º—É</button>

  <h2 style="margin-top: 30px;" id="addQuestionTitle">–î–æ–¥–∞—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è –¥–æ —Ç–µ–º–∏</h2>
  <select id="test-select">
    <option value="">–û–±–µ—Ä—ñ—Ç—å —Ç–µ–º—É</option>
  </select>
  <button class="action" id="deleteTestBtn" onclick="deleteTest()">–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ–º—É</button>

  <input type="text" id="question-text" placeholder="–¢–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è">
  <input type="number" id="question-difficulty" placeholder="–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å (1-3)">

  <div id="answers-container">
    <input type="text" class="answer-input" placeholder="–í–∞—Ä—ñ–∞–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ 1">
    <input type="text" class="answer-input" placeholder="–í–∞—Ä—ñ–∞–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ 2">
    <input type="text" class="answer-input" placeholder="–í–∞—Ä—ñ–∞–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ 3">
    <input type="text" class="answer-input" placeholder="–í–∞—Ä—ñ–∞–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ 4">
  </div>

  <input type="number" id="correct-index" placeholder="–ù–æ–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (1-4)">
  <button class="action" id="addQuestionBtn" onclick="addQuestion()">–î–æ–¥–∞—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è</button>
</div>

<script>
  const translations = {
    uk: {
      adminTitle: "–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å",
      homeBtn: "–ì–æ–ª–æ–≤–Ω–∞",
      videoBtn: "–í—ñ–¥–µ–æ-—É—Ä–æ–∫–∏",
      testsBtn: "–¢–µ—Å—Ç–∏",
      videoListTitle: "–°–ø–∏—Å–æ–∫ –≤—ñ–¥–µ–æ",
      deleteVideoBtn: "–í–∏–¥–∞–ª–∏—Ç–∏",
      addVideoTitle: "–î–æ–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ",
      addVideoBtn: "–î–æ–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ",
      newTestTitle: "–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ç–µ–º—É —Ç–µ—Å—Ç—É",
      createTestBtn: "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–º—É",
      addQuestionTitle: "–î–æ–¥–∞—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è –¥–æ —Ç–µ–º–∏",
      deleteTestBtn: "–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ–º—É",
      addQuestionBtn: "–î–æ–¥–∞—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è",
      testSelectPlaceholder: "–û–±–µ—Ä—ñ—Ç—å —Ç–µ–º—É",
      videoPlaceholder: "–ù–∞–∑–≤–∞ –≤—ñ–¥–µ–æ",
      urlPlaceholder: "–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤—ñ–¥–µ–æ",
    },
    en: {
      adminTitle: "Admin Panel",
      homeBtn: "Home",
      videoBtn: "Video Lessons",
      testsBtn: "Tests",
      videoListTitle: "Video List",
      deleteVideoBtn: "Delete",
      addVideoTitle: "Add Video",
      addVideoBtn: "Add Video",
      newTestTitle: "Add New Test Topic",
      createTestBtn: "Create Topic",
      addQuestionTitle: "Add Question to Topic",
      deleteTestBtn: "Delete Topic",
      addQuestionBtn: "Add Question",
      testSelectPlaceholder: "Select topic",
      videoPlaceholder: "Video title",
      urlPlaceholder: "Video URL",
    }
  };

  let lang = 'uk';

  function toggleLang() {
    lang = lang === 'uk' ? 'en' : 'uk';
    applyLang();
  }

  function applyLang() {
    const t = translations[lang];
    document.getElementById("adminTitle").textContent = t.adminTitle;
    document.getElementById("homeBtn").textContent = t.homeBtn;
    document.getElementById("videoBtn").textContent = t.videoBtn;
    document.getElementById("testsBtn").textContent = t.testsBtn;

    document.getElementById("videoListTitle").textContent = t.videoListTitle;
    document.getElementById("deleteVideoBtn").textContent = t.deleteVideoBtn;
    document.getElementById("addVideoTitle").textContent = t.addVideoTitle;
    document.getElementById("addVideoBtn").textContent = t.addVideoBtn;

    document.getElementById("newTestTitle").textContent = t.newTestTitle;
    document.getElementById("createTestBtn").textContent = t.createTestBtn;
    document.getElementById("addQuestionTitle").textContent = t.addQuestionTitle;
    document.getElementById("deleteTestBtn").textContent = t.deleteTestBtn;
    document.getElementById("addQuestionBtn").textContent = t.addQuestionBtn;

    document.getElementById("video-title").placeholder = t.videoPlaceholder;
    document.getElementById("video-url").placeholder = t.urlPlaceholder;
    document.getElementById("test-select").options[0].textContent = t.testSelectPlaceholder;
  }

  function showPanel(id) {
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    if (id === 'video') loadVideos();
    if (id === 'tests') loadTests();
  }

  function goToHome() {
    window.location.href = 'Main.html';
  }

  document.addEventListener('DOMContentLoaded', () => {
    loadTests();
    applyLang();
  });
   function showPanel(id) {
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if (id === 'video') loadVideos();
      if (id === 'tests') loadTests();
    }

    function goToHome() {
      window.location.href = 'Main.html';
    }

    let selectedVideoId = null;

    async function loadVideos() {
      const res = await fetch('https://pdd-api.duckdns.org/api/video');
      const videos = await res.json();
      const list = document.getElementById('video-list');
      list.innerHTML = '';
      videos.forEach(v => {
        const li = document.createElement('li');
        li.textContent = `${v.title}`;
        li.onclick = () => {
          document.querySelectorAll('#video-list li').forEach(el => el.classList.remove('selected'));
          li.classList.add('selected');
          selectedVideoId = v.videoId;
        };
        list.appendChild(li);
      });
    }

    async function deleteVideo() {
      if (!selectedVideoId) return;
      await fetch(`http://185.233.36.82:5000/api/video/${selectedVideoId}`, { method: 'DELETE' });
      loadVideos();
    }

    async function addVideo() {
      const title = document.getElementById('video-title').value;
      const videoUrl = document.getElementById('video-url').value;
      await fetch('https://pdd-api.duckdns.org/api/video', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, videoUrl })
      });
      document.getElementById('video-title').value = '';
      document.getElementById('video-url').value = '';
      loadVideos();
    }

    <!-- –ó–∞–º—ñ–Ω–∞ createTest() -->
async function createTest() {
  const title = document.getElementById('new-test-title').value.trim();
  if (!title) return alert("–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–µ–º–∏!");

  const res = await fetch('https://pdd-api.duckdns.org/api/AdminTests/create-test', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ title })
  });

  if (res.ok) {
    alert("–¢–µ–º—É —Å—Ç–≤–æ—Ä–µ–Ω–æ!");
    document.getElementById('new-test-title').value = '';
    loadTests();
  } else {
    alert("–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–º–∏");
  }
}


async function loadTests() {
  const res = await fetch('https://pdd-api.duckdns.org/api/AdminTests');
  if (!res.ok) {
    alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–µ–º–∏');
    return;
  }

  const tests = await res.json();
  const select = document.getElementById('test-select');
  select.innerHTML = '<option value="">–û–±–µ—Ä—ñ—Ç—å —Ç–µ–º—É</option>';

  tests.forEach(t => {
    const opt = document.createElement('option');
    opt.value = t.testID ?? t.id;  
    opt.textContent = t.title;
    select.appendChild(opt);
  });
}


async function addQuestion() {
  const testId = document.getElementById('test-select').value;
  const text = document.getElementById('question-text').value.trim();
  const difficulty = +document.getElementById('question-difficulty').value;
  const answerInputs = document.querySelectorAll('.answer-input');
  const correctIndex = +document.getElementById('correct-index').value - 1;

  if (!testId || !text || difficulty < 1 || difficulty > 3 || answerInputs.length < 4 || correctIndex < 0 || correctIndex > 3) {
    return alert("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ!");
  }

  const answers = Array.from(answerInputs).map((input, i) => ({
    text: input.value.trim(),
    isCorrect: i === correctIndex
  }));

  if (answers.some(a => !a.text)) {
    return alert("–£—Å—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ");
  }

  const question = {
    text,
    difficulty,
    testID: +testId,
    answers
  };

  const res = await fetch('https://pdd-api.duckdns.org/api/AdminTests/add-question', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(question)
  });

  if (res.ok) {
    alert("–ü–∏—Ç–∞–Ω–Ω—è –¥–æ–¥–∞–Ω–æ!");
    document.getElementById('question-text').value = '';
    document.getElementById('question-difficulty').value = '';
    document.getElementById('correct-index').value = '';
    answerInputs.forEach(i => i.value = '');
  } else {
    alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è");
  }
}

async function deleteTest() {
  const testId = document.getElementById('test-select').value;
  if (!testId) return alert("–û–±–µ—Ä—ñ—Ç—å —Ç–µ–º—É –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è!");

  if (!confirm("–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é —Ç–µ–º—É?")) return;

  const res = await fetch(`https://pdd-api.duckdns.org/api/AdminTests/${testId}`, {
    method: 'DELETE'
  });

  if (res.ok) {
    alert("–¢–µ–º—É –≤–∏–¥–∞–ª–µ–Ω–æ");
    loadTests();
  } else {
    alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ —Ç–µ–º–∏");
  }
}

    document.addEventListener('DOMContentLoaded', loadTests);
  </script>
 

</body>
</html>
